# -*- makefile-gmake -*-
#
#    Copyright (C) 2012, Duzy Chan <code@duzy.info>.
#    All rights reserved.
#
$(smart.internal)

#$(warning info: save $(NAME), $(SRCDIR), $(@name))

define smart~save.simple
$(eval \
  ifdef $(smart~name)
    smart.context.$(smart~name)-$(@name) := $($(smart~name))
  endif
 )
endef #smart~save.simple

define smart~save.recursive
$(eval \
  ifdef $(smart~name)
    smart.context.$(smart~name)-$(@name) = $(value $(smart~name))
  endif
 )
endef #smart~save.recursive

#define smart~save.undefined
#endef #smart~save.undefined

define smart~save
$(smart~save.$(flavor $(smart~name)))
endef #smart~save

$(foreach smart~name,$(smart.context.names),$(smart~save))
$(foreach smart~name,$(smart.context.names:%=EXPORT.%),$(smart~save))

ifdef smart.scripts.$(NAME)
  smart.scripts.$(NAME) += $(@name)
else
  smart.scripts.$(NAME) := $(@name)
endif

smart.names-$(@name) := $(NAME)
smart.list += $(@name)

smart~save.simple :=
smart~save.recursive :=
smart~save :=
smart~name :=
