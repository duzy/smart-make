# -*- shell-script -*-
function run ()
{
    local files=( \
	"out/objs/android-14-armeabi/a1.o" \
	"out/objs/android-14-armeabi-v7a/a2.o" \
	"out/objs/android-9-mips/a3.o" \
	"out/objs/android-9-x86/a3.o" \
	"out/libs/armeabi/ndk.so" \
	"out/libs/armeabi-v7a/ndk.so" \
	"out/libs/mips/ndk.so" \
	"out/libs/x86/ndk.so" \
	"out/libs/mips/ndktest" \
	"out/libs/x86/ndktest" \
	"out/a1.native" \
	"out/a2.native" \
	"out/a3.native" \
	"out/a4.native" \
	)

    rm -rf ${files[@]} out

    local lines=$(smart)
    if false; then
	echo "========================================"
	echo "$lines"
	echo "========================================"
    fi

    check-files files

    files=( \
	"./out/libs/armeabi/ndk.so" \
	)
    lines=($(cat "out/a1.native"))
    check-same-set files lines

    files=( \
	"./out/libs/armeabi-v7a/ndk.so" \
	)
    lines=($(cat "out/a2.native"))
    check-same-set files lines

    files=( \
	"./out/libs/x86/ndk.so" \
	"./out/libs/mips/ndk.so" \
	)
    lines=($(cat "out/a3.native"))
    check-same-set files lines

    files=( \
	"./out/libs/x86/ndktest" \
	"./out/libs/mips/ndktest" \
	)
    lines=($(cat "out/a4.native"))
    check-same-set files lines
}
