# -*- makefile-gmake -*-
#
#    Copyright (C) 2012, Duzy Chan <code@duzy.info>.
#    All rights reserved.
#
$(smart.internal)

#$(warning info: save $(NAME), $(SRCDIR), $(@script))

define smart~save.simple
$(eval \
  ifdef $(smart~name)
    smart.context.$(smart~name)-$(@script) := $($(smart~name))
  endif
 )
endef #smart~save.simple

define smart~save.recursive
$(eval \
  ifdef $(smart~name)
    smart.context.$(smart~name)-$(@script) = $(value $(smart~name))
  endif
 )
endef #smart~save.recursive

#define smart~save.undefined
#endef #smart~save.undefined

define smart~save
$(smart~save.$(flavor $(smart~name)))
endef #smart~save

$(foreach smart~name,$(filter $(smart.context.names),$(.VARIABLES)),$(smart~save))

ifdef smart.scripts.$(NAME)
  smart.scripts.$(NAME) += $(@script)
else
  smart.scripts.$(NAME) := $(@script)
endif

smart.names-$(@script) := $(NAME)
smart.list += $(@script)

smart~save.simple :=
smart~save.recursive :=
smart~save :=
smart~name :=
